<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Victoria Peñafiel, Nelson Sarmiento">

<title>Predicción de la diabetes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="repaso_files/libs/clipboard/clipboard.min.js"></script>
<script src="repaso_files/libs/quarto-html/quarto.js"></script>
<script src="repaso_files/libs/quarto-html/popper.min.js"></script>
<script src="repaso_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="repaso_files/libs/quarto-html/anchor.min.js"></script>
<link href="repaso_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="repaso_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="repaso_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="repaso_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="repaso_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicción de la diabetes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Victoria Peñafiel, Nelson Sarmiento </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="intro" class="level1">
<h1>Intro</h1>
<p>Este sería un ejemplo de examen El siguiente conjunto de datos, consiste en predecir a pacientes basandonos en datos clínicos, si puede padecer diabetes o no.</p>
<p>Antes de cualquier método de clasificación, regresión o lo que sea, necesitamos explorar los datos.</p>
<p>Esto supone exámenes estadísticos inferenciales univariantes, bivariantes y multivariantes.</p>
</section>
<section id="pima-indians-diabetes-database" class="level1">
<h1>Pima Indians Diabetes Database</h1>
<p>This dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the dataset is to diagnostically predict whether or not a patient has diabetes, based on certain diagnostic measurements included in the dataset. Several constraints were placed on the selection of these instances from a larger database. In particular, all patients here are females at least 21 years old of Pima Indian heritage.</p>
</section>
<section id="cargamos-librerias" class="level1">
<h1>Cargamos librerias</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comenzamos cargando las librerías que seran utilizadas para correr al código</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co">#Esta librería sirve para generar los distintos gráficos del programa.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co">#Esta librería sirve para los data frames y sus distintas funciones.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co">#Esta librería sirve para generar los entrenamientos y evaluaciones de los modelos que se utilizan en el código.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071) <span class="co">#Esta librería sirve para generar algoritmos de los modelos Knn, Bayes y árboles de decisión</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#Esta librería sirve para agregar estadíticas a los grafícos como un descripción de los intevalor, p_value, entre otros.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>You can cite this package as:
     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.
     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167</code></pre>
</div>
</div>
</section>
<section id="cargamos-los-datos" class="level1">
<h1>Cargamos los datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Se lee los datos diabetes.cvs y estos son cargados en la variable creada con nombre datos</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos) <span class="co">#Se visualiza una matriz de 9 columnas donde se muestra la categoría de los datos y 6 filas donde se encuentran los datos numérico.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies Glucose BloodPressure SkinThickness Insulin  BMI
1           6     148            72            35       0 33.6
2           1      85            66            29       0 26.6
3           8     183            64             0       0 23.3
4           1      89            66            23      94 28.1
5           0     137            40            35     168 43.1
6           5     116            74             0       0 25.6
  DiabetesPedigreeFunction Age Outcome
1                    0.627  50       1
2                    0.351  31       0
3                    0.672  32       1
4                    0.167  21       0
5                    2.288  33       1
6                    0.201  30       0</code></pre>
</div>
</div>
<p>Si echamos una búsqueda rápida en google, observamos que el pedigree, es eso, la historia familiar de diabetes. Por lo tanto, aquí podríamos hacer varias cosas ! Entre ellas, regresar los datos a dicha función, o clasificar según esta variable, considerarla o no considerarla.</p>
<p>Para empezar vamos a considerarla para ver la clasificación del modelo knn y bayes.</p>
<section id="miramos-las-clases-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="miramos-las-clases-de-los-datos">Miramos las clases de los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datos) <span class="co">#Esta línea de código nos muestra un resumen con la etiqueta del nombre de las nueve variables, el tipo de datos de cada una y varios datos numéricos de cada una de las observaciones. Adémas de que en este data.frame tambien de observa el número total de variable y sus observaciones.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   768 obs. of  9 variables:
 $ Pregnancies             : int  6 1 8 1 0 5 3 10 2 8 ...
 $ Glucose                 : int  148 85 183 89 137 116 78 115 197 125 ...
 $ BloodPressure           : int  72 66 64 66 40 74 50 0 70 96 ...
 $ SkinThickness           : int  35 29 0 23 35 0 32 0 45 0 ...
 $ Insulin                 : int  0 0 0 94 168 0 88 0 543 0 ...
 $ BMI                     : num  33.6 26.6 23.3 28.1 43.1 25.6 31 35.3 30.5 0 ...
 $ DiabetesPedigreeFunction: num  0.627 0.351 0.672 0.167 2.288 ...
 $ Age                     : int  50 31 32 21 33 30 26 29 53 54 ...
 $ Outcome                 : int  1 0 1 0 1 0 1 0 1 1 ...</code></pre>
</div>
</div>
<p>La única variable que debemos de cambiar es <code>Outcome</code> a factor. Donde 1 es diebetes, y 0 es no diabetes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Transformación: Convertimos la variable Outcome en un factor, se realiza esto para que los datos solo puedan ser 1 en el caso de tener diabetes y 0 en el caso de No diabetes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="análisis-estadístico-preliminar" class="level1">
<h1>Análisis estadístico preliminar</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos) <span class="co">#Con la función dim podemos conocer las dimensiones totales del data.frame, como se observa este contiene 9 variables que se encuentra en las columnas y 768 observaciones que se encuentran en las filas.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 768   9</code></pre>
</div>
</div>
<p>Tenemos 768 filas y 9 columnas. Analicemos primero dos a dos las variables una por una</p>
<section id="histogramas" class="level3">
<h3 class="anchored" data-anchor-id="histogramas">Histogramas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#En este código graficaremos el histograma de los datos.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>) <span class="co">#En esta línea creamos la variables l.plots con el objetivo de hacer una lista vacia, la longitud del vector es ncol de los datos -1 porque se esta quitando o excluyendo la columna Outcome. </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span> <span class="co">#Esta línea de código almacena en  la variable n1 el número de columnas de los datos menos 1 por que tambien se excluye a la columna Outcome.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){ <span class="co">#Esta línea crea un bucle for que comienza en 1 y se va iterando hasta el valor de n1.</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F) <span class="co">#En esta variable se crea el histograma con los valores iniciales del bucle.</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome) <span class="co">#En esta línea se crea un nuevo Data Frame con los valores de la columna j y los datos de la variable Outcome que tiene valores de 0 y 1.</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j])) <span class="co">#En la variable p1 se crea el objeto con la librería ggplot que contiene el histograma creado con la columna j, sumado las columnas de color de la variable Outcome más el titulo del histograma creado ‘Histograma de’ mas el nombre de la columna j.</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1 <span class="co">#La variable p1 se guarda en la lista creada al principio l.plots.</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="co">#Es esta línea se manda a plotear, imprimir o visualizar los histogramas creados.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En lo particular la variable del pedigree se me hace importante, entonces vamos a realizar gráficos de dispersión</p>
<p>En realidad, una buena práctica es correlacionar todas contra todas…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(datos,BMI,DiabetesPedigreeFunction) <span class="co">#En esta línea de código se crea un gráfico de dispersión utilizando las columnas BMI y DiabetesPedigreeFunction, en donde BMI Va en la escala horizonta y DiabetesPedifreeFunction va en el eje vertical. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'ggside':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sin embargo, esto puede ser un proceso tedioso… imaginad hacer 16 gráficas ! podemos condersarlo todo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]) <span class="co">#Para acortar las gráficas con esta línea se genera una matriz de correlación  para el Data Frame de los datos totales y de esta manera encontrar el p_value y el coeficiente de corelación, para cada par de valores y asi no ir haciendo de dos en dos hasta tener las 16 gráficas.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p <span class="co">#En el vector p.values se almacena los p valores de la herramienta utilizada en la primera línea corr.test.</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj <span class="co">#Con esta línea se reemplzan los valores de p en el triangulo superior de la matriz con los valores corregidos, estos se encuentran almacenados en obj.cor$p.adj.</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj <span class="co">#De la misma manera que la línea anterior se reemplazan los valores ahora se lo realiza en el triangulo inferior de la matriz.</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#Con esta línea se establecen los valores que van en la diagonal de la matriz asignandole un valor de 1.</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>) <span class="co">#En esta línea se crea el diagrama de la matriz correlación con opciones para ser personalizado, este ráfico mostrara las correlaciones significativas resaltandolas y las no significativas serán etiquetadas. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora podemos proceder a hacer algo similar, con una serie de comparaciones dos a dos sobre las medias o medianas, sobre cada variable y la variable de interés.</p>
<p>Primero debemos aplicar una regresión lineal con variable dependiente cada variable numérica y por la categórica. Es decir un t.test pero con el fin de ver los residuos, para ver la normalidad de éstos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome))<span class="sc">$</span>residuals), <span class="co">#Es toda esta línea de código hasta el parentesis, se esta realizando un modelo de regresión lineal a la columna de los datos y con la función summary se crea un resumen de modelo de regresión y con $residuals se saca los residuos del modelo. </span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      shapiro.test) <span class="co"># En esta línea se aplica el test de Shapiro Wilk a los residuos obtenidos de la regresión lineal. Con la función apply de principio se aplica este test sobre cada columna pero ahora de los residuos.</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>p.norm <span class="co">#Esta variable almacena los resultados de los valores p del test de Shapiro Wilk para cada columna de residuos, siendo esta variable una matriz que almacena la normalidad de los residuos.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pregnancies

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.9389, p-value &lt; 2.2e-16


$Glucose

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97511, p-value = 3.726e-10


$BloodPressure

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.81468, p-value &lt; 2.2e-16


$SkinThickness

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.92004, p-value &lt; 2.2e-16


$Insulin

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.77776, p-value &lt; 2.2e-16


$BMI

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.94359, p-value &lt; 2.2e-16


$DiabetesPedigreeFunction

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.84939, p-value &lt; 2.2e-16


$Age

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.88114, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Todas las variables son no normales, tal como vemos en los histogramas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Código de relaciones</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Pregnancies,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#Esta línea crea un cuadro estadístico mediante un gráfico para observar la relación que existe entre las variables Outcome y Pregnancies de los datos ingresados y definiendo el tipo método a utilizar en este caso es no paramétrico. Esta gráfica se la conoce con el nombre de violín y se va observando como cada varible interactua con el nivel de las otras variables y su distribución.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Glucose,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#Se repite el procedimiento de anteriormente realizado en el cuadro de gráfica de relaciones pero en este caso se observa las relaciones de los datos entre las variables Outcome y Glucosa.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,BloodPressure,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#De la misma manera ahora para las variables Outcome y BloodPressure.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Insulin,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#En este caso se ve la relación entre las variables Outcome y Insulin.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,BMI,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#Ahora se realiza el gráfico para las variables Outcome y BMI.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,DiabetesPedigreeFunction,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#En esta línea de código se saca el gráfico Outcome y DiabetesPedigreeFunction.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Age,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="co">#De la misma manera ahora para las variables Outcome y Age.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pca" class="level3">
<h3 class="anchored" data-anchor-id="pca">PCA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos) <span class="co">#En esta línea de código se realiza un resumen para cada una de las variables de los datos, como son minímo, quiartiles, median, mediana,máximo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :  0.0   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 30.5   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 79.8   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   :846.0   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> F) <span class="do">## escalamos por la variablidad de los datos. Realizamos en esta línea el PCA reduciendo la dimensión del conjunto de datos y da la orden que no escale las variables el PCA.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome) <span class="co">#En plotpca se genera un nuevo Data Frame en el cual se encuentran las puntuaciones del PCA y la columna Outcome.</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#En esta línea se crea el diagrama de dispersión de los puntajes calculados anteriormente del PCA y estas van a tener el color según Outcome un color para 0 y otro para 1.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora vamos a ver si haciendo unas transformaciones esto cambia. Pero antes debemos de ver las variables sospechosas…</p>
<p>Pero de igual manera podemos escalar a ver si hay algun cambio…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos) <span class="co">#Summaty es una función que realiza un resumen estadistico en este caso de los datos.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :  0.0   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 30.5   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 79.8   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   :846.0   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos, al contrario del anterior código en este caso se da la orden que se escale los datos el PCA.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome) <span class="co">#Repetimos el procedimiento anterior de la creación del Dataframe.</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#Con esta línea mandamos a gráficar la dispersión de los datos con los colores que da la variable Outcome.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_contrib</span>(pcx,<span class="st">"var"</span>) <span class="co">#Gráficamos un diagrama de barras de las contribuciones que realizan cada una de las variables a la variable pcx.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Al parecer es la insulina la que está dando problemas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## indices a quitar</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">grep</span>(<span class="st">"insulin"</span>,<span class="at">ignore.case =</span> T,<span class="fu">colnames</span>(datos)),<span class="fu">ncol</span>(datos)) <span class="co">#En la variable w se guardan los índices que contengan la pablabra insulin.</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="sc">-</span>w],<span class="at">scale. =</span> F) <span class="do">## escalamos por la variablidad de los datos, se da la orden de que el PCA no escale las variables.</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#Tanto con la línea de plotpaca y está se manda a gráficar sel cuadro de dispersión de los datos coloreandolos con Outcome. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>De hecho la insulina, tenía un aspecto raro, como sesgado, ver gráficos de arriba. Vamos a transformala…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Insulin  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Insulin<span class="fl">+0.05</span>) <span class="co">#A los valores de Insulin se le suma un 0.05 para transformar a estos valores haciendolos más apropiados para una distribución normal y de estos utilizamos la función log() y sacamos su logaritmo.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos) <span class="co">#Resumen de los datos estadisticos para cada variable.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin            BMI        DiabetesPedigreeFunction      Age       
 Min.   :-2.996   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:-2.996   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 3.418   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 1.008   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.: 4.847   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   : 6.741   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos, se da la orden para que los datos sean escalados del PCA.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome) <span class="co">#Con bind se convina las columnas del PCA con los resultados.</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#Con las dos últimas líneas de código se grafica el cuadro de dispersión de los datos y se colorea con la variable Outcome. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Cambia ! Esto significa que no hemos quitado la infromacion de la insulina, solamente lo hemos transformado</p>
<p>Es decir, cambia si transformamos los datos…a partir de esto, podemos realizar de nuevo pruebas de diferencia de medianas, pero ahora lo veremos condensado..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Se lee los datos de diabetes.csv y se los guarda en datos.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Transformarmos la variable Outcome a un factor, de 1 y 0 a indicadores de diabete o no.</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>datsc <span class="ot">&lt;-</span> <span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]) <span class="co">#Se escala los datos menos los de la variable Outcome.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos las distribuciones de nuevo….</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>) <span class="co">#En l.plot se crea el vector lista el cual tiene la longitud de -1 de los datos excluyendo a la columna Outcome.</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span> <span class="co">#n1 va a almacenar al numero total de columnas menos 1 porque se excluye la variable Outcome.</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){ <span class="co">#Se crea un bucle con for que se va a iterar desde j comenzando en 1 hasta el valor de n1.</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F) <span class="co">#En h se crea el histograma de los datos de la columna especificada por j y el argumento plot=Falso retira el trazado del histograma.</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome) <span class="co">#Se crea un data frame en datos.tmp con los valores de la columna que es indicada por j y la variables de resultado.</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j])) <span class="co">#En p1 se crea el histograma con los datos personalizados, el título, los colores son dados por Outcome, los valores y etiquetas de los ejes.</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1 <span class="co">#se guarda en el vector lista l.plot el histograma creado en p1.</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>l.plots <span class="co">#Se visualiza la lista de histogramas creados.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Curioso, los valores la insulina, han cambiado por la transformación en valor mas no la distribución, vamos a hacer unos arrelgos…</p>
<p>Al parecer la preñanza esta ligada a una esgala logaritmica de 2 Esto es otra cosa…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Leemos los datos de diabetes.csv y los guardamos en datos.</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Transformamos los datos de Outcome a factor</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Pregnancies  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Pregnancies<span class="fl">+0.5</span>) <span class="co">#Se añade un valor de 0.5 a los datos de Pregnancies y luego se toma el logaritmo de cada unos de los valores.</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(Pregnancies))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">hist</span>(datos<span class="sc">$</span>Pregnancies,<span class="at">plot=</span>F)<span class="sc">$</span>breaks) <span class="co">#Se crea el histograma para estos valores de la variable Pregnancies, especificando la estética del mismo. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Realizaremos lo mismo con la grosura de la piel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Leemos los datos de diabetes.csv y los guardamos en datos.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Se convierte en factor a la columna Outcome.</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>SkinThickness  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>SkinThickness<span class="fl">+0.5</span>) <span class="co">#A los valores de la variable SkinThickness se le suma 0.5 y se saca el valor del logaritmo de ellos.</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(SkinThickness))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">hist</span>(datos<span class="sc">$</span>SkinThickness,<span class="at">plot=</span>F)<span class="sc">$</span>breaks) <span class="co">#Se crea el histograma de esta variable y se especifica la estética del mismo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tenemos algo raro, lo más posible sea por la obesidad…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(datos,SkinThickness,BMI) <span class="co">#Se crea un diagrama de dispersión de relación entre la variable SkinThickness y BMI.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Curioso ! al parecer los datos tienen valores nulos, los cuales solo están en las otras variables que no sean pregnancies. Vamos a quitarlos…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Se leen los datos de diabetes.csv y se los alamcena en datos. </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x)) <span class="co">#En esta línea se reemplazan los valores del Data Frame que tienen 0 por NA, con el objetivo de eliminar las filas que no sirven para los modelos de entrenamiento automático.</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x)) <span class="co">#En esta línea se reemplazan los valores del </span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Se convierten los valores de Outcome a factor es decir se pasa de binario a un indicador de tener o no diabetes. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vamos-a-quitar-estos-valores" class="level3">
<h3 class="anchored" data-anchor-id="vamos-a-quitar-estos-valores">Vamos a quitar estos valores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos[<span class="fu">complete.cases</span>(datos),] <span class="co">#Esta fila utiliza el comando complete.cases que devuelve un vector que indica si las filas contienen todos los valores.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se redujo el data set a 392 observaciones…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Esta línea usa el comando table que utiliza un vector y entrega una tabla que en este caso ve cada uno de los valores y los cuenta, como la variable Outcome es binaria devulve el total de 0 y 1.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
262 130 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>) <span class="co">#Se creea el vecto lista con una longitud de menos 1 porque se excluye la variable Outcome.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span> <span class="co">#n1 guarda el número total de columnas que se utilizara en el bucle. </span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){ </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>} <span class="co">#Como en los anteriores códigos se utiliza el bucle for para crear el histograma con cada una de las variables, dandole las especificaciones para la estética, los colres y los ejes y su título.</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>l.plots <span class="co">#Gráfica todos los histogramas creados.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora si podemos realizar las transfomraciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Leemos los datos de diabetes.csv y los guardamos en datos.</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x)) <span class="co">#Reemplazamos con NA los valores de cero de datos.</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos[<span class="fu">complete.cases</span>(datos),] <span class="co">#Elimina las filas de datos que contengan valores que no se encuentren.</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Transforma a factor los valores de la cariable Outcome.</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Insulin <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Insulin) <span class="co">#Se obtiene el logaritmo de la variable Insulin de los datos leidos.</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Pregnancies <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Pregnancies<span class="fl">+0.5</span>) <span class="co">#Se suma 0.5 a los valores de la variable Pregnancies y despues se obtiene el logaritmo de cada uno.</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>DiabetesPedigreeFunction <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>DiabetesPedigreeFunction) <span class="co">#Se obtiene el logaritmo con la función log de la columan DiabetesPedigreeFunction.</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>SkinThickness <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((datos<span class="sc">$</span>SkinThickness)) <span class="co">#Se calcula la raiz cuadrada de la variable SkinThinckness. </span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Glucose <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Glucose) <span class="co">#Se obtiene elvalor del logaritmo de Glucosa.</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Age <span class="ot">&lt;-</span><span class="fu">log2</span>(datos<span class="sc">$</span>Age) <span class="co">#Se obtiene el logaritmo de base 2 de la variable Age o edad.</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>) <span class="co">#Se creea el vecto lista con una longitud de menos 1 porque se excluye la variable Outcome.</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span> <span class="co">#n1 guarda el número total de columnas que se utilizara en el bucle. </span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>} <span class="co">#Como en los anteriores códigos se utiliza el bucle for para crear el histograma con cada una de las variables, dandole las especificaciones para la estética, los colres y los ejes y su título.</span></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>l.plots <span class="co">#Gráfica todos los histogramas creados.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Con las anteriores transformaciones vamos a realizar el PCA de nuevo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos) <span class="co"># Realiza el resumen estadisticos de los datos.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies         Glucose      BloodPressure    SkinThickness  
 Min.   :-0.6931   Min.   :4.025   Min.   : 24.00   Min.   :2.646  
 1st Qu.: 0.4055   1st Qu.:4.595   1st Qu.: 62.00   1st Qu.:4.583  
 Median : 0.9163   Median :4.779   Median : 70.00   Median :5.385  
 Mean   : 0.9590   Mean   :4.778   Mean   : 70.66   Mean   :5.305  
 3rd Qu.: 1.7047   3rd Qu.:4.963   3rd Qu.: 78.00   3rd Qu.:6.083  
 Max.   : 2.8622   Max.   :5.288   Max.   :110.00   Max.   :7.937  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :2.639   Min.   :18.20   Min.   :-2.4651          Min.   :4.392  
 1st Qu.:4.341   1st Qu.:28.40   1st Qu.:-1.3103          1st Qu.:4.524  
 Median :4.832   Median :33.20   Median :-0.7996          Median :4.755  
 Mean   :4.813   Mean   :33.09   Mean   :-0.8391          Mean   :4.882  
 3rd Qu.:5.247   3rd Qu.:37.10   3rd Qu.:-0.3754          3rd Qu.:5.170  
 Max.   :6.741   Max.   :67.10   Max.   : 0.8838          Max.   :6.340  
 Outcome
 0:262  
 1:130  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos, se da la orden para que se escalen los valore y se realice el PCA.</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#Plotean el diagrama de dispersión de los datos coloreandolos con los valores de Outcome.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora vamos a realizar las pruebas de medianas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(<span class="fu">scale</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]),</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome))<span class="sc">$</span>residuals),</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>      shapiro.test)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Como anteriormente se realizo estas líneas de código se utilizan para realizar el tes de Shapiro-Wilk con los residuos de la regresión lineal realizado a la variable outcome. </span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>p.norm <span class="co">#Visualiza los valores encontrados del vector p.norm que se guardaron del test Shapiro-Wilk.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pregnancies

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.95146, p-value = 4.684e-10


$Glucose

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.9958, p-value = 0.3813


$BloodPressure

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99011, p-value = 0.009686


$SkinThickness

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99384, p-value = 0.1123


$Insulin

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99054, p-value = 0.0128


$BMI

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97122, p-value = 5.374e-07


$DiabetesPedigreeFunction

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99456, p-value = 0.1796


$Age

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.93053, p-value = 1.561e-12</code></pre>
</div>
</div>
<p>Hemos conseguido la normalidad en solo dos variables, si fueran mas procederiamos con t test pero como no es asi, con test de Wilcoxon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">scale</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]), <span class="co">#Esta línea manda la orden para escalar los valores en el DataFrame. </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">wilcox.test</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome)<span class="sc">$</span>p.value) <span class="co">#Esta línea de código realiza la prueba de Wilcoxon que es la de suma de rangos de cada valor escalado y los suma con los valores de Outcome.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observamos que en una primera instancia ahora todas tienen diferencias significativas, esto tenemos que corregir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>p.adj <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.norm,<span class="st">"BH"</span>) <span class="co">#Se realiza un adjuste por el método BM de Benjamin Hochberg sobre los valores almacenados en la variable p.norm y se guardan en el vector p.adj.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Todas siguen siendo significativas, ahora vamos a ver cuales aumentan o disminyuen respecto las otras</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>datos.split <span class="ot">&lt;-</span> <span class="fu">split</span>(datos,datos<span class="sc">$</span>Outcome) <span class="co">#Divide en dos grupos a todos los datos, cda grupos para un valor de la variable Outcome.</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>datos.median <span class="ot">&lt;-</span> <span class="fu">lapply</span>(datos.split, <span class="cf">function</span>(x) <span class="fu">apply</span>(x[,<span class="sc">-</span><span class="fu">ncol</span>(x)],<span class="dv">2</span>,median)) <span class="co">#Calcula la mediana para cada uno de los valores de cada grupo.</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>toplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">medianas=</span><span class="fu">Reduce</span>(<span class="st">"-"</span>,datos.median)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>,<span class="at">p.values=</span>p.adj) <span class="co">#Se crea una gráfica superior del DataFrame en donde se visualizaran las medianas y los p.value.</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>toplot <span class="co">#Visualizamos la tabla.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           medianas     p.values
Pregnancies              -0.3364722 8.957407e-05
Glucose                  -0.2957935 4.902429e-22
BloodPressure            -4.0000000 8.957407e-05
SkinThickness            -0.5484102 4.309442e-07
Insulin                  -0.4788534 3.241934e-13
BMI                      -3.3500000 2.574728e-07
DiabetesPedigreeFunction -0.2779529 8.957407e-05
Age                      -0.4005379 1.577456e-14</code></pre>
</div>
</div>
<p>Ahora Todos los valores son significativos respecto a la obesidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El siguiente código realiza la gráfica de corellación que existe entre cada una de las variables con las otras, etiquetando y subrayando los valores que tienen relación y los que no tienen. Adémas dandole una estructura entendible para observar claramente las relaciones que existen, encontrando valores más siginificativos de acuerdo a la obesidad. </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>También podemos observar como cambian las relaciones segun la diabetes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#De la misma forma que el anterior con las siguientes líneas de código encontramos la gráfica de relaciones pero en este caso se encontraran los valores más significativos de acuerdo a diabetes. </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[datos<span class="sc">$</span>Outcome<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Como los dos anteriores, este código realiza un análisis de correlación entre la variables, corrige los valores de p y visualiza la matriz final de relaciones.</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[datos<span class="sc">$</span>Outcome<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Es decir, existen correlaciones únicas de la obesidad y no obesidad, y existen otras correlaciones que son debidas a otros factores.</p>
</section>
</section>
<section id="particion-de-datos" class="level1">
<h1>Particion de datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])) <span class="co">#Escala las variables excepto una de las columnas de los datos.</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>) <span class="co">#Transforma la variable Outcome en factores de dos niveles D y N.</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>) <span class="co">#Divide a datos en un grupos de datos de entrenamiento y en otro de evaluación, los datos de entrenamiento al 70% y los de evaluación al 30%.</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,] <span class="co">#Guarda los datos de entrenamiento.</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,] <span class="co">#Guarda los datos de prueba.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelado" class="level1">
<h1>Modelado</h1>
<section id="regresión-logística" class="level4">
<h4 class="anchored" data-anchor-id="regresión-logística">Regresión logística</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])) <span class="co">#Escala las variables excepto una de las columnas de los datos.</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>glm.mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Outcome <span class="sc">~</span>.,<span class="at">data=</span>dat.train,<span class="at">family =</span> <span class="st">"binomial"</span>) <span class="co">#Realiza una regresión logistica a los valores del entrenamiento.</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">predict</span>(glm.mod,dat.test,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="st">"N"</span>,<span class="st">"D"</span>)) <span class="co">#Esta línea realiza predicciones de los valores del grupo de evaluación.</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome) <span class="co">#Mediante una matriz de confusión evalua el rendimiento del modelo de regresión.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 68 18
         N 13 19
                                         
               Accuracy : 0.7373         
                 95% CI : (0.6483, 0.814)
    No Information Rate : 0.6864         
    P-Value [Acc &gt; NIR] : 0.1369         
                                         
                  Kappa : 0.3665         
                                         
 Mcnemar's Test P-Value : 0.4725         
                                         
            Sensitivity : 0.8395         
            Specificity : 0.5135         
         Pos Pred Value : 0.7907         
         Neg Pred Value : 0.5937         
             Prevalence : 0.6864         
         Detection Rate : 0.5763         
   Detection Prevalence : 0.7288         
      Balanced Accuracy : 0.6765         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
</section>
<section id="lasso" class="level4">
<h4 class="anchored" data-anchor-id="lasso">LASSO</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>tuneGrid<span class="ot">=</span><span class="fu">expand.grid</span>(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">.alpha=</span><span class="dv">0</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">.lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)) <span class="co">#Realiza una tabla con los valores para cada valor de datos con alpha=0 y lambda va aumentando de 0.001.</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>trainControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># prSummary needs calculated class,</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">classProbs =</span> T) <span class="co">#Crea un control para la validación cruzada que realiza el modelo con sus especificaciones.</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> trainControl,<span class="at">tuneGrid=</span>tuneGrid,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">metric=</span><span class="st">"Accuracy"</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>) <span class="co">#En estas líneas se va ajustando a una regresión lineal penalizando al grupo de datos de entrenamiento utilizando la tabla con alpha y lambda y el control que se creo. </span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(model,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]),dat.test<span class="sc">$</span>Outcome) <span class="co">#Con la matriz confusión se evalua el rendimiento del modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 75 19
         N  6 18
                                         
               Accuracy : 0.7881         
                 95% CI : (0.7033, 0.858)
    No Information Rate : 0.6864         
    P-Value [Acc &gt; NIR] : 0.009468       
                                         
                  Kappa : 0.4559         
                                         
 Mcnemar's Test P-Value : 0.016395       
                                         
            Sensitivity : 0.9259         
            Specificity : 0.4865         
         Pos Pred Value : 0.7979         
         Neg Pred Value : 0.7500         
             Prevalence : 0.6864         
         Detection Rate : 0.6356         
   Detection Prevalence : 0.7966         
      Balanced Accuracy : 0.7062         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
</section>
<section id="ridge" class="level4">
<h4 class="anchored" data-anchor-id="ridge">Ridge</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>tuneGrid<span class="ot">=</span><span class="fu">expand.grid</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">.alpha=</span><span class="dv">1</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">.lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.0001</span>)) <span class="co">#Realiza una tabla con los valores para cada valor de datos en este caso con alpha=1 y lambda va aumentando de 0.001.</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>trainControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># prSummary needs calculated class,</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">classProbs =</span> T) <span class="co">#Crea un control para la validación cruzada que realiza el modelo con sus especificaciones.</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> trainControl,<span class="at">tuneGrid=</span>tuneGrid,</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">metric=</span><span class="st">"Accuracy"</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>) <span class="co">#En estas líneas se va ajustando a una regresión lineal penalizando al grupo de datos de entrenamiento utilizando la tabla y el control.</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(model,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]),dat.test<span class="sc">$</span>Outcome) <span class="co">#Se predice los valores del modelo y se evalua al mismo con la matriz confusión su rendimiento.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 69 17
         N 12 20
                                          
               Accuracy : 0.7542          
                 95% CI : (0.6665, 0.8288)
    No Information Rate : 0.6864          
    P-Value [Acc &gt; NIR] : 0.06607         
                                          
                  Kappa : 0.4073          
                                          
 Mcnemar's Test P-Value : 0.45761         
                                          
            Sensitivity : 0.8519          
            Specificity : 0.5405          
         Pos Pred Value : 0.8023          
         Neg Pred Value : 0.6250          
             Prevalence : 0.6864          
         Detection Rate : 0.5847          
   Detection Prevalence : 0.7288          
      Balanced Accuracy : 0.6962          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
</section>
<section id="naive-bayes" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes">Naive Bayes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Realizamos una nueva partición de datos tanto de entrenamiento como de prueba.</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])) </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,] <span class="co">#Datos de entrenamiento.</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,] <span class="co">#Datos de prueba.</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Outcome <span class="sc">~</span> .,<span class="at">data=</span>dat.train,<span class="at">laplace =</span> <span class="dv">0</span>) <span class="co">#En este caso aplicaremos el modelo Naive Bayes, en donde la variable Outcome actua como la variable dependiente y las démas como independientes. En este caso no se utiliza en suavizado de Laplace por eso su valor esta igualado a 0.</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span><span class="fu">predict</span>(mdl,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]) <span class="co">#Esta línea realiza la predicción del conjunto de datos de prueba y se utiliza todas las columnas excepto la de Outcome.</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome) <span class="co">#Con la matriz confusión de evalua el rendimiento del modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 59 13
         N 23 23
                                          
               Accuracy : 0.6949          
                 95% CI : (0.6034, 0.7763)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.5449          
                                          
                  Kappa : 0.3325          
                                          
 Mcnemar's Test P-Value : 0.1336          
                                          
            Sensitivity : 0.7195          
            Specificity : 0.6389          
         Pos Pred Value : 0.8194          
         Neg Pred Value : 0.5000          
             Prevalence : 0.6949          
         Detection Rate : 0.5000          
   Detection Prevalence : 0.6102          
      Balanced Accuracy : 0.6792          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>lambda_use <span class="ot">&lt;-</span> <span class="fu">min</span>(model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda[model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda <span class="sc">&gt;=</span> model<span class="sc">$</span>bestTune<span class="sc">$</span>lambda]) <span class="co">#Se encuentra el valor más pequeño del vector. </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">which</span>(model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda <span class="sc">==</span> lambda_use) <span class="co"># En esta línea se encuentra el índice del valor más pequeño del vector que debe ser mayo o igual a model$bestTune$lambda.</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>featsele <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">coef</span>(model<span class="sc">$</span>finalModel)[, position]) <span class="co">#Esta línea crea un objeto que contiene los coeficientes del modelo ajustado.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(featsele)[featsele<span class="sc">$</span>coef.model.finalModel....position.<span class="sc">!=</span><span class="dv">0</span>] <span class="co">#Con esta línea se selecciona los coeficiente que sean diferentes de cero y entrega la características más importantes para este ajuste del modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(Intercept)"              "Glucose"                 
[3] "SkinThickness"            "Insulin"                 
[5] "BMI"                      "DiabetesPedigreeFunction"
[7] "Age"                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>mdl.sel <span class="ot">&lt;-</span><span class="fu">naiveBayes</span>(Outcome <span class="sc">~</span> Insulin<span class="sc">+</span>Glucose<span class="sc">+</span>DiabetesPedigreeFunction<span class="sc">+</span>Age,<span class="at">data =</span> dat.train) <span class="co">#Se utiliza el modelo Naive Byes para ajustar los datos, siendo Outcome la variables dependiente y las démas independientes.</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl.sel,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]) <span class="co">#Predecimos los valores del modelo de todas las columnas excepto la de Outcome.</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome) <span class="co">#Con la matriz confusión evaluamos el rendimiento del modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 60 10
         N 22 26
                                          
               Accuracy : 0.7288          
                 95% CI : (0.6392, 0.8065)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.24421         
                                          
                  Kappa : 0.4151          
                                          
 Mcnemar's Test P-Value : 0.05183         
                                          
            Sensitivity : 0.7317          
            Specificity : 0.7222          
         Pos Pred Value : 0.8571          
         Neg Pred Value : 0.5417          
             Prevalence : 0.6949          
         Detection Rate : 0.5085          
   Detection Prevalence : 0.5932          
      Balanced Accuracy : 0.7270          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
</section>
<section id="knn" class="level4">
<h4 class="anchored" data-anchor-id="knn">KNN</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR) <span class="co">#Esta librería se utiliza porque tiene algunas funciones que funcionan para el entrenamiento de knn.</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co">#Esta librería igual que la anterior tienen funciones que se utilizan para el entrenamiento de este modelo.</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">400</span>) <span class="co">#Se determina una semilla para evitar que los resultados no sean erroneos.</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">repeats =</span> <span class="dv">3</span>) <span class="co">#,classProbs=TRUE,summaryFunction = twoClassSummary) #Se crea un objeto de control en donde se utiliza como método repeatedcv esto significa que la validación cruzada se realizará 10 veces con tres repeticiones.</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>knnFit <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"knn"</span>, <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="at">tuneLength =</span> <span class="dv">50</span>) <span class="co">#Se establece el modelo de ajuste que en este caso es knn que es el modelo de k vecinos más cercanos.</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Output of kNN fit</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>knnFit <span class="co">#Se vusualizara los valores predecidos por el modelo. Tanto de k, el Accuracy y los valores de kappa.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

274 samples
  8 predictor
  2 classes: 'D', 'N' 

Pre-processing: centered (8), scaled (8) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 246, 246, 247, 246, 246, 247, ... 
Resampling results across tuning parameters:

  k    Accuracy   Kappa    
    5  0.7851852  0.4996603
    7  0.7885802  0.5105744
    9  0.7896384  0.5136580
   11  0.7946649  0.5233689
   13  0.8007055  0.5297756
   15  0.8044092  0.5422528
   17  0.8115961  0.5575842
   19  0.8153880  0.5635472
   21  0.8141093  0.5624283
   23  0.8042769  0.5391170
   25  0.8006173  0.5260056
   27  0.8017637  0.5288484
   29  0.8078924  0.5420432
   31  0.8018078  0.5280332
   33  0.7981922  0.5204593
   35  0.7969577  0.5168039
   37  0.7945326  0.5091562
   39  0.7956790  0.5127017
   41  0.7956790  0.5125508
   43  0.7956349  0.5116454
   45  0.7944444  0.5082804
   47  0.7870811  0.4903479
   49  0.7932099  0.5022354
   51  0.7932099  0.5016438
   53  0.7920194  0.4973315
   55  0.7955908  0.5072241
   57  0.7944444  0.5070859
   59  0.7883157  0.4908856
   61  0.7894621  0.4924749
   63  0.7906085  0.4915362
   65  0.7919753  0.4969068
   67  0.7932099  0.4978668
   69  0.7907407  0.4911946
   71  0.7858907  0.4779037
   73  0.7822310  0.4672299
   75  0.7785273  0.4568355
   77  0.7795855  0.4571985
   79  0.7820106  0.4626169
   81  0.7832892  0.4652528
   83  0.7833333  0.4654112
   85  0.7869929  0.4730295
   87  0.7881834  0.4750217
   89  0.7870370  0.4711723
   91  0.7882716  0.4745771
   93  0.7906966  0.4788659
   95  0.7883157  0.4704739
   97  0.7870811  0.4658391
   99  0.7870811  0.4624231
  101  0.7834215  0.4536780
  103  0.7761464  0.4339753

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was k = 19.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knnFit) <span class="co">#Se crea la gráfica de knnFit que fue el objeto creado para el modelo knn.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>knnPredict <span class="ot">&lt;-</span> <span class="fu">predict</span>(knnFit,<span class="at">newdata =</span> dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)] ) <span class="co">#Esta línea de código realiza la predicción utilizando el modelo knn en los datos de prueba y estos son guardados en knnPredict.</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the confusion matrix to see accuracy value and other parameter values</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knnPredict, dat.test<span class="sc">$</span>Outcome ) <span class="co">#Se imprime la matriz confusión para este modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 67 20
         N 15 16
                                          
               Accuracy : 0.7034          
                 95% CI : (0.6123, 0.7839)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.4654          
                                          
                  Kappa : 0.2721          
                                          
 Mcnemar's Test P-Value : 0.4990          
                                          
            Sensitivity : 0.8171          
            Specificity : 0.4444          
         Pos Pred Value : 0.7701          
         Neg Pred Value : 0.5161          
             Prevalence : 0.6949          
         Detection Rate : 0.5678          
   Detection Prevalence : 0.7373          
      Balanced Accuracy : 0.6308          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co">#Librería que contiene varias funciones para el modelo.</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Leemos los datos de diabete.csv y los guardamos en datos.</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Convertimos la variable Outcome en factor</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])) <span class="co">#Escalamos los datos del DataFrame</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>) <span class="co">#Se cambia lo niveles de la variable Outcome por D y N.</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>) <span class="co">#Se parten los datos.</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,] <span class="co">#Datos de entrenamiento.</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,] <span class="co">#Datos de Prueba.</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>) <span class="co">#Se siembra la semilla.</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>ctrl<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">number=</span><span class="dv">10</span>,<span class="at">classProbs =</span> <span class="cn">TRUE</span>,<span class="at">summaryFunction =</span> twoClassSummary) <span class="co">#Se realiza un objeto control el cual realizara la validación cruzada 10 veces con 3 pliegues cada uno.</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>plsda<span class="ot">&lt;-</span><span class="fu">train</span>(<span class="at">x=</span>dat.train[,<span class="sc">-</span><span class="fu">ncol</span>(datos)], <span class="co"># spectral data</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>dat.train<span class="sc">$</span>Outcome, <span class="co"># factor vector</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"pls"</span>, <span class="co"># pls-da algorithm</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">tuneLength=</span><span class="dv">10</span>, <span class="co"># number of components</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">trControl=</span>ctrl, <span class="co"># ctrl contained cross-validation option</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="co"># the data are centered and scaled</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">metric=</span><span class="st">"ROC"</span>) <span class="co"># metric is ROC for 2 classes</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>plsda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Partial Least Squares 

537 samples
  8 predictor
  2 classes: 'D', 'N' 

Pre-processing: centered (8), scaled (8) 
Resampling: Cross-Validated (10 fold, repeated 1 times) 
Summary of sample sizes: 483, 484, 483, 483, 483, 483, ... 
Resampling results across tuning parameters:

  ncomp  ROC        Sens       Spec     
  1      0.8113961  0.8558824  0.5298246
  2      0.8276869  0.8904202  0.5666667
  3      0.8292806  0.8845378  0.5771930
  4      0.8288250  0.8875630  0.5771930
  5      0.8306207  0.8875630  0.5824561
  6      0.8307710  0.8875630  0.5771930
  7      0.8307710  0.8875630  0.5771930

ROC was used to select the optimal model using the largest value.
The final value used for the model was ncomp = 6.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsda,<span class="at">newdata =</span> dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]) <span class="co">#Se realiza una predicción utilizando el método plsda en los datos de prueba.</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome) <span class="co">#Se muestra la matriz final del método</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   D   N
         D 128  37
         N  24  42
                                          
               Accuracy : 0.7359          
                 95% CI : (0.6741, 0.7916)
    No Information Rate : 0.658           
    P-Value [Acc &gt; NIR] : 0.006761        
                                          
                  Kappa : 0.3891          
                                          
 Mcnemar's Test P-Value : 0.124430        
                                          
            Sensitivity : 0.8421          
            Specificity : 0.5316          
         Pos Pred Value : 0.7758          
         Neg Pred Value : 0.6364          
             Prevalence : 0.6580          
         Detection Rate : 0.5541          
   Detection Prevalence : 0.7143          
      Balanced Accuracy : 0.6869          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<p>Si tuneamos lambda</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Leemos los datos de diabetes.csv.</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Se convierte en factor a los valores de Outcome. </span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>) <span class="co">#Se cambia los niveles de Outcome por D y N.</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>) <span class="co">#Se realiza una partición de datos.</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,] <span class="co">#Datos de entrenamiento.</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,] <span class="co">#Datos de prueba.</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.1</span>) <span class="co">#Se crea el vector lambda con parámetro para regularización</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(dat.train[,<span class="sc">-</span><span class="fu">ncol</span>(datos)],dat.train<span class="sc">$</span>Outcome) <span class="co">#En este caso se realiza un ajuste utilizando el modelo de Naive Bayes, en todas las columnas menos la de Outcome.</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>  predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]) <span class="co">#Se realiza la predicción del modelo en los datos de prueba.</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicciones,dat.test<span class="sc">$</span>Outcome)<span class="sc">$</span>overall[<span class="dv">1</span>] <span class="co">#Se visualiza el valor de accuracy del modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Accuracy 
0.7705628 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="co">#Leemos los datos de diabetes.csv.</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="co">#Se convierte en factor a los valores de Outcome. </span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])) <span class="co">#Realiza la normalización de los datos y los reemplaza dentro de datos.</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>) <span class="co">#Se cambia los niveles de Outcome por D y N.</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>) <span class="co">#Partición de los datos de entrenamiento y prueba.</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,] <span class="co">#Datos de entrenamiento.</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,] <span class="co">#Datos de prueba</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co">#Librería</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>) <span class="co">#Plantar la semilla</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>ctrl<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">number=</span><span class="dv">10</span>,<span class="at">classProbs =</span> <span class="cn">TRUE</span>,<span class="at">summaryFunction =</span> twoClassSummary) <span class="co">#Definición del objeto de control. </span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>plsda<span class="ot">&lt;-</span><span class="fu">train</span>(<span class="at">x=</span>dat.train[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)], <span class="co"># spectral data</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>dat.train<span class="sc">$</span>Outcome, <span class="co"># factor vector</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"pls"</span>, <span class="co"># pls-da algorithm</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">tuneLength=</span><span class="dv">10</span>, <span class="co"># number of components</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">trControl=</span>ctrl, <span class="co"># ctrl contained cross-validation option</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="co"># the data are centered and scaled</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">metric=</span><span class="st">"ROC"</span>) <span class="co"># metric is ROC for 2 classes</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsda,dat.test[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)]) <span class="co">#Predicción del modelo.</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome) <span class="co">#Matriz confusión del modelo.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   D   N
         D 136  42
         N   9  44
                                         
               Accuracy : 0.7792         
                 95% CI : (0.7201, 0.831)
    No Information Rate : 0.6277         
    P-Value [Acc &gt; NIR] : 5.532e-07      
                                         
                  Kappa : 0.4876         
                                         
 Mcnemar's Test P-Value : 7.433e-06      
                                         
            Sensitivity : 0.9379         
            Specificity : 0.5116         
         Pos Pred Value : 0.7640         
         Neg Pred Value : 0.8302         
             Prevalence : 0.6277         
         Detection Rate : 0.5887         
   Detection Prevalence : 0.7706         
      Balanced Accuracy : 0.7248         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
<p>Finalmente podríamos hacer un análisis de la varianza multivariante</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan) <span class="co">#Librería para análisis multivariante</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is vegan 2.6-4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'vegan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:caret':

    tolerance</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis2</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)] <span class="sc">~</span>datos<span class="sc">$</span>Outcome,<span class="at">method =</span> <span class="st">"euclidean"</span>) <span class="co">#El resultado del análisis se mostrará con las estadísticas y los valores p.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = datos[, -ncol(datos)] ~ datos$Outcome, method = "euclidean")
               Df SumOfSqs      R2      F Pr(&gt;F)    
datos$Outcome   1    357.8 0.05831 47.434  0.001 ***
Residual      766   5778.2 0.94169                  
Total         767   6136.0 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Es decir, como conlusión aunque las variables no pueden detectar la diabetes, siendo variables independientes, si por otro lado las consideramos dependientes de la diabetes.</p>
<p>Es decir, la diabetes es una condición en la que influye en los parámetros, mientras que es menos probable que la diabetes sea la causa de estas alteraciones, con una mejor precisón del 77 por ciento.</p>
<p>Es decir, por un lado tenemos las variables que nos explican solo un 77 porciento de la diabetes, mientras que la condición en sí nos separa más entre la media global.</p>
<p>Se podría investigar más esto. Por ejemplo, se podría hacer una correlación parcial, dada la diabetes, e identificar aquellas variables especificamente relacionadas con esta.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>